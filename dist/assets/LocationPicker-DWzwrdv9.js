const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mapbox-gl-uLhxzSZm.js","assets/index-BZoA0LaG.js","assets/index-BfpDBnYb.css"])))=>i.map(i=>d[i]);
import{r as c,j as s,X as C,_ as L}from"./index-BZoA0LaG.js";function _({isOpen:d,onClose:b,onLocationSelect:x,loading:h,useCurrentLocation:w,handleSelectLocation:y}){const u=c.useRef(null),j=c.useRef(null),[i,v]=c.useState(""),[m,k]=c.useState(null),[g,p]=c.useState(!1),N=(e,r)=>{let o=0;return(...a)=>{const t=new Date().getTime();t-o<r||(o=t,e(...a))}},f=c.useCallback(async(e,r)=>{var a,t;let o="";try{const l=await(await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e},${r}.json?access_token=pk.eyJ1IjoiLS11bHJpa2siLCJhIjoiY203YzV5dHIyMGY3NjJqc2Q5MmpxNm4ycCJ9.TilyKOmKcw2ekL2PY8Xofw`)).json();o=((t=(a=l==null?void 0:l.features)==null?void 0:a[0])==null?void 0:t.place_name)||""}catch(n){console.warn("Reverse geocoding failed:",n)}k(n=>!n||n.lng!==e||n.lat!==r?{lng:e,lat:r}:n),v(o),x(e,r,o)},[x]);return c.useEffect(()=>{if(!d||!u.current)return;let e;return(async()=>{const o=await L(()=>import("./mapbox-gl-uLhxzSZm.js").then(t=>t.m),__vite__mapDeps([0,1,2]));o.default.accessToken="pk.eyJ1IjoiLS11bHJpa2siLCJhIjoiY203YzV5dHIyMGY3NjJqc2Q5MmpxNm4ycCJ9.TilyKOmKcw2ekL2PY8Xofw";let a=[39.2083,-6.7924];if(navigator.geolocation)try{const t=await new Promise((n,l)=>navigator.geolocation.getCurrentPosition(n,l));a=[t.coords.longitude,t.coords.latitude]}catch{}e=new o.Map({container:u.current,style:"mapbox://styles/mapbox/streets-v11",center:a,zoom:13}),e.on("load",()=>{const t=e.getCenter();f(t.lng,t.lat)}),e.on("moveend",N(()=>{const t=e.getCenter();f(t.lng,t.lat)},500)),j.current=e})(),()=>{e==null||e.remove()}},[d,f]),d?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:s.jsxs("div",{className:"bg-[#ededed] dark:bg-[#2b2b2b] p-6 rounded-lg shadow-lg w-[90%] max-w-md",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-lg font-bold text-[#00bfff]",children:"Select Location"}),s.jsx("button",{onClick:b,children:s.jsx(C,{className:"h-5 w-5 text-gray-600 dark:text-white"})})]}),s.jsxs("div",{className:"mt-4 h-64 rounded overflow-hidden relative",children:[s.jsx("div",{ref:u,className:"w-full h-full rounded"}),s.jsx("div",{className:"pointer-events-none absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-full z-10",children:s.jsx("img",{src:"/icons/icons8-map-pin-100.png",className:"w-20 h-20",alt:"marker"})})]}),s.jsx("button",{onClick:()=>{m&&i&&(y({lat:m.lat,lng:m.lng,name:i}),p(!0),setTimeout(()=>p(!1),1500))},className:`mt-4 w-full ${g?"bg-green-500 hover:bg-green-600":"bg-[#00bfff] hover:bg-[#0099cc]"} text-white py-2 px-4 rounded text-center font-semibold transition-colors duration-300`,children:i?g?"Location Selected!":i:"Loading address..."}),s.jsx("ul",{className:"mt-4 space-y-2",children:s.jsx("li",{onClick:w,className:"p-2 flex justify-center rounded-md cursor-pointer border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition text-blue-500 font-medium",children:h?s.jsxs("svg",{className:"animate-spin h-5 w-5 text-[#2b2b2b]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Use my current location"})})]})}):null}export{_ as default};
