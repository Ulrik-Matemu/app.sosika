import{c as x,r,j as e,a as o,b as $,d as j,B as N,C as A}from"./index-yinvR2rm.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],B=x("ThumbsDown",U);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],q=x("ThumbsUp",L);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],O=x("Utensils",F),m=r.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:o("rounded-xl border bg-card text-card-foreground shadow",s),...t}));m.displayName="Card";const u=r.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:o("flex flex-col space-y-1.5 p-6",s),...t}));u.displayName="CardHeader";const y=r.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:o("font-semibold leading-none tracking-tight",s),...t}));y.displayName="CardTitle";const w=r.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:o("text-sm text-muted-foreground",s),...t}));w.displayName="CardDescription";const h=r.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:o("p-6 pt-0",s),...t}));h.displayName="CardContent";const b=r.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:o("flex items-center p-6 pt-0",s),...t}));b.displayName="CardFooter";function c({className:s,...t}){return e.jsx("div",{className:o("animate-pulse rounded-md bg-primary/10",s),...t})}const V=()=>{const[s,t]=r.useState(null),[n,i]=r.useState(!0),[k,l]=r.useState(null),{toast:f}=$();r.useEffect(()=>{v()},[]);const v=async()=>{try{i(!0);const a=localStorage.getItem("userId");if(!a){l("User ID is missing. Please log in again."),i(!1);return}const d=await j.get(`https://sosika-backend.onrender.com/api/one-tap/${a}`);d.data.success?t(d.data.recommendation):l("Couldn't get a recommendation at this time")}catch(a){console.error("Error fetching recommendation:",a),l("Something went wrong. Please try again.")}finally{i(!1)}},C=()=>{p(!0),f({title:"Success!",description:"The item has been added to your preferences. Thanks for your feedback!",duration:2e3})},I=()=>{p(!1),f({title:"Recommendation rejected",description:"We'll improve our suggestions based on your feedback.",duration:3e3})},p=async a=>{const d=localStorage.getItem("userId");try{await j.post(`https://sosika-backend.onrender.com/api/feedback/${d}`,{recommendationId:s==null?void 0:s.recommendedItemId,accepted:a,itemOrdered:a?s==null?void 0:s.recommendedItemId:null})}catch(_){console.error("Error sending feedback:",_)}},R=a=>a>=.8?"bg-green-100 text-green-800":a>=.6?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",T=()=>{const a=new Date().getHours();return a>=5&&a<12?"breakfast":a>=12&&a<17?"lunch":a>=17&&a<22?"dinner":"snack"},D=()=>{const a=T();return{breakfast:"Good morning! Hungry for breakfast?",lunch:"It's lunchtime! How about this?",dinner:"Dinner time! We think you'd enjoy:",snack:"Need a bite? How about this:"}[a]};if(n)return e.jsxs(m,{className:"w-full  max-w-md mx-auto shadow-md hover:shadow-lg transition-shadow",children:[e.jsxs(u,{className:"pb-2",children:[e.jsx(c,{className:"h-4 w-3/4 mb-2"}),e.jsx(c,{className:"h-6 w-full"})]}),e.jsx(h,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"h-4 w-24"}),e.jsx(c,{className:"h-6 w-32"})]}),e.jsx(c,{className:"h-10 w-24 rounded-full"})]})})]});if(k||!s)return null;const{recommendedItemName:H,vendorName:M,price:S,confidence:g}=s,E=R(g);return e.jsxs(m,{className:"w-full max-w-md mx-auto shadow-md hover:shadow-lg transition-shadow",children:[e.jsxs(u,{className:"pb-2",children:[e.jsxs(w,{className:"text-sm font-medium",children:[" ",e.jsx("span",{className:"text-[12px] text-blue-500 bg-blue-100 px-2 py-[2px] rounded-full",children:"AI Pick"}),"   ",D()]}),e.jsx(y,{className:"text-xl",children:H})]}),e.jsx(h,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3"})," ",M]}),e.jsxs("p",{className:"text-lg font-semibold",children:["$",S]}),e.jsxs("div",{className:`inline-flex items-center text-xs px-2 py-1 rounded-full mt-2 ${E}`,children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),Math.round(g*100),"% match"]})]}),e.jsxs(N,{onClick:C,className:"rounded-full px-4",children:["Accept ",e.jsx(A,{className:"h-4 w-4 ml-1"})]})]})}),e.jsx(b,{className:"justify-end pt-0",children:e.jsxs(N,{variant:"ghost",size:"sm",onClick:I,className:"text-gray-500 hover:text-gray-700",children:["Not interested ",e.jsx(B,{className:"h-3 w-3 ml-1"})]})})]})};export{V as default};
